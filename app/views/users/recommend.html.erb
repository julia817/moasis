<%= provide(:title, "#{@user.username}のおすすめリスト") %>

<% if @movielist.nil? %>
	<h2>おすすめ作品のリスト（0本）</h2>
<% else %>
	<h2>おすすめ作品のリスト（<%= @recommend.count %>本）</h2>
<% end %>

<% if !@recommend.blank? %>
  <div class="addthis_inline_share_toolbox"></div>
	<table border="1">
    <tr>
			<th>Poster</th>
			<th>Title</th>
			<th>Release Date</th>
			<th>Description</th>
			<th>Add at</th>
			<% if current_user?(User.find(@movielist.user_id)) %>
				<th>Action</th>
			<% end %>
    </tr>
    <% @recommend.each do |m| %>
    	<% movie = Movie.details(m.movie_id) %>
    	<tr>
        <td>
        	<%= image_tag("https://image.tmdb.org/t/p/w200#{movie["poster_path"]}",
        								:alt => "poster") %>
        </td>
        <td>
        	<%= link_to movie["title"],
        							controller: "movies", action: "show", id: "#{movie["id"]}" %>
        </td>
        <td><%= movie["release_date"] %></td>
        <td>
        	<% if movie["overview"].blank? %>
            情報がありません
          <% else %>
        		<%= movie["overview"] %>
        	<% end %>
        </td>
        <td><%= m["created_at"].strftime('%Y/%m/%d') %></td>
				<% if current_user?(User.find(@movielist.user_id)) %>
        	<td>
            <%= button_to "削除", list_movies_destroy_path,
                          :method => "delete",
                          :class => "btn btn-md btn-danger",
                          :data => { :confirm => "本当に削除しますか？" },
                          :params => {:movielist_id => @movielist.id, :movie_id => movie["id"]} %> 
          </td>
        <% end %>
    	</tr>
    <% end %>
	</table>
<% end %>

<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5befb8322ae303d6"></script>